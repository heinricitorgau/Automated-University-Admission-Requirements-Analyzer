# University Ranking Crawler - é–‹ç™¼èˆ‡æ¶æ§‹æ—¥èªŒ

## 1. ç¨‹å¼æ¶æ§‹èªªæ˜ (Refactored v2.0)

æœ¬å°ˆæ¡ˆå·²æ–¼ 2026/02/17 å®Œæˆæ¨¡çµ„åŒ–é‡æ§‹ï¼Œæ¡ç”¨åˆ†å±¤æ¶æ§‹ä»¥æå‡å¯ç¶­è­·æ€§ã€‚

### ç›®éŒ„çµæ§‹
```
clawer/
â”œâ”€â”€ clawer_main.py         # ğŸš€ ç¨‹å¼å…¥å£ (Entry Point)
â”œâ”€â”€ constants/             # ğŸ“š å¸¸é‡å®šç¾© (Data Layer)
â”‚   â”œâ”€â”€ presets.py         # æ’å ID èˆ‡ URL é è¨­å€¼
â”‚   â”œâ”€â”€ countries.py       # åœ‹å®¶ä»£ç¢¼èˆ‡åç¨±å°ç…§
â”‚   â””â”€â”€ regions.py         # åœ°å€åˆ†çµ„å®šç¾©
â”œâ”€â”€ ui/                    # ğŸ–¥ï¸ ä½¿ç”¨è€…ä»‹é¢ (Presentation Layer)
â”‚   â”œâ”€â”€ cli.py             # å‘½ä»¤è¡Œåƒæ•¸è§£æ
â”‚   â”œâ”€â”€ interactive.py     # äº¤äº’å¼é¸å–®é‚è¼¯
â”‚   â””â”€â”€ validators.py      # è¼¸å…¥é©—è­‰èˆ‡è™•ç†
â”œâ”€â”€ utils/                 # ğŸ› ï¸ é€šç”¨å·¥å…· (Utility Layer)
â”‚   â”œâ”€â”€ logging.py         # æ—¥èªŒè¨­å®š
â”‚   â”œâ”€â”€ retry.py           # é‡è©¦æ©Ÿåˆ¶è£é£¾å™¨
â”‚   â”œâ”€â”€ formatters.py      # æ•¸æ“šæ ¼å¼åŒ–å‡½æ•¸
â”‚   â””â”€â”€ cache.py           # ç°¡å–®å¿«å–å¯¦ä½œ
â”œâ”€â”€ crawler.py             # ğŸ® æ ¸å¿ƒæ§åˆ¶å™¨ (Controller)
â”œâ”€â”€ fetcher.py             # ğŸŒ ç¶²è·¯å‚³è¼¸ (Network Layer)
â”œâ”€â”€ extractor.py           # ğŸ” è³‡æ–™è§£æ (Parsing Layer)
â”œâ”€â”€ exporter.py            # ğŸ’¾ è³‡æ–™è¼¸å‡º (Output Layer)
â”œâ”€â”€ config.py              # âš™ï¸ é…ç½®ç®¡ç† (Configuration)
â””â”€â”€ models.py              # ğŸ“¦ è³‡æ–™æ¨¡å‹ (Model)
```

### æ ¸å¿ƒæ¨¡çµ„è·è²¬
* **clawer_main.py**: æ¥µç°¡åŒ–çš„å…¥å£ï¼Œè² è²¬åˆ¤æ–·å•Ÿå‹• CLI æˆ–äº¤äº’æ¨¡å¼ã€‚
* **crawler.py**: ç¸½æŒ‡æ® (Orchestrator)ã€‚è² è²¬åˆå§‹åŒ– Configï¼Œå”èª¿ Fetcher ä¸‹è¼‰ã€Extractor è§£æï¼Œæœ€å¾Œäº¤ç”± Exporter è¼¸å‡ºã€‚
* **fetcher.py**: è² è²¬æ‰€æœ‰ HTTP è«‹æ±‚ï¼Œè™•ç† Headersã€Cookiesã€SSL é©—è­‰èˆ‡éŒ¯èª¤é‡è©¦ã€‚
* **extractor.py**: å¾ HTML/JSON ä¸­æå–çµæ§‹åŒ–è³‡æ–™ã€‚
* **exporter.py**: æ”¯æ´ Console, CSV, Excel, JSON å¤šç¨®è¼¸å‡ºæ ¼å¼ã€‚
* **config.py**: é›†ä¸­ç®¡ç†æ‰€æœ‰è¨­å®šã€‚

---

## 2. Note (èˆŠç‰ˆæ¶æ§‹åƒè€ƒ)

* ~~clawer1_updated_patched.py~~: (å·²æ£„ç”¨) èˆŠç‰ˆå…¥å£ã€‚
* ~~utils.py~~: (èˆŠç‰ˆ) æ··åˆæ‰€æœ‰å·¥å…·å‡½æ•¸ï¼Œç¾å·²æ‹†åˆ†ã€‚

---

## 3. Diary (é–‹ç™¼æ—¥èªŒ)

### 2/11/2026  
**Implementing Country in Overall Ranking Table**

- åœ¨ä¸»è¡¨èˆ‡æ¬¡é †ä½è¡¨æ ¼åŠ å…¥ Country æ¬„ä½  
- åŒæ­¥æ›´æ–° Console / CSV / Excel / JSON  
- å»ºç«‹ mock æ¸¬è©¦è…³æœ¬é©—è­‰ç‰ˆé¢  

---

### 2/12/2026  
**Default Ranking Behavior Adjustment (World TOP 100 as Default)**

- å°‡ `country` é è¨­æ”¹ç‚º `None`  
- æœªæŒ‡å®šåœ‹å®¶ â†’ World TOP 100  
- æŒ‡å®šåœ‹å®¶ â†’ National Ranking  

---

### 2/13/2026  
**Ranking Logic Refactoring (Overall Ranking Optional Mode)**

- ç¬¬äºŒé †ä½é è¨­é—œé–‰  
- ç¬¬ä¸€é †ä½å®Œæˆå¾Œè©¢å•æ˜¯å¦åŸ·è¡Œ Overall  
- æ”¹ç‚º conditional execution  
- æ¸›å°‘ API å‘¼å«èˆ‡åŸ·è¡Œæ™‚é–“  

---

### 2/14/2026  
**Code Cleanup & UI Refinements**

- ç§»é™¤èˆŠç‰ˆ Docstrings  
- Console è¡¨æ ¼å„ªåŒ–  
- å°é½Š QS æŒ‡æ¨™æ¬„ä½  
- æ¬„ä½è‡ªå‹•éš±è—  

---

### 2/14/2026  
**Subject Ranking ä¿®å¾©èˆ‡ç©©å®šæ€§å„ªåŒ–**

- ä¿®æ­£åˆ†é çµ‚æ­¢æ¢ä»¶  
- å¼·åŒ–éŒ¯èª¤å›å ±  
- æé«˜ timeout ä¸¦æš«åœ Subject async  

---

### 2/15/2026  
**éŒ¯èª¤è™•ç†èˆ‡ç©©å®šæ€§ä¿®æ­£**

- ä¿®æ­£ brotli è§£ç¢¼å•é¡Œ  
- å¯¦ä½œ Retry  
- ä¿®æ­£ SSL é©—è­‰  
- ä¿®å¾© QS API 404  

---

### 2/17/2026  
**æ¨¡çµ„åŒ–é‡æ§‹**

- å»ºç«‹ `ui`, `constants`, `utils`  
- ç˜¦èº« clawer_main.py  
- é©—è­‰ç„¡ Regression  

---

### 2/19/2026  
**Performance Boost**

- é è¨­å•Ÿç”¨ async  
- æå‡ä¸¦ç™¼æ•¸  
- é™ä½ request delay  

---

## 4. ç³»çµ±ç©©å®šåº¦è©•ä¼° (v2.0)

| æ¨¡å¼ | ç©©å®šåº¦ | å‚™è¨» |
| :--- | :--- | :--- |
| World Ranking | â­ é«˜ | API ç©©å®š |
| Subject Ranking | ğŸŒ— ä¸­ | å¶ç™¼ Timeout |
| National Ranking | ğŸŒ— ä¸­ | å¤§åœ‹è³‡æ–™é‡å¤§ |
| Async æ¨¡å¼ | âš ï¸ ä¸­ä½ | éœ€æ§åˆ¶ä¸¦ç™¼ |

---

## 5. æœªä¾†å‡ç´šæ–¹å‘

- å¼•å…¥ Semaphore æ§åˆ¶ä¸¦ç™¼  
- å¯¦ä½œ Exponential Backoff  
- åŠ å…¥ SQLite å¿«å–  
- å»ºç«‹éŒ„å–é›£åº¦é æ¸¬æ¨¡å‹  
